---
alwaysApply: true
---
# Правила разработки кода

## Общие принципы

- **Простота**: Любая сложность оправдана только реальной необходимостью
- **Минимализм**: Только необходимый функционал для базовой работы
- **Понятность**: Код должен быть очевиден без комментариев
- **Конкретика**: Избегать абстракций "на будущее"

## Структура кода

- Один файл = одна ответственность
- Максимальная длина функции — 20 строк
- Максимальный размер файла — 200 строк
- Если превышаешь — разбивай

## Обработка ошибок

- Логировать все ошибки через `logging`
- Не падать тихо: если ошибка — в лог
- Для пользователя: простое сообщение об ошибке

## Именование

- Переменные и функции: `snake_case`
- Классы: `PascalCase`
- Константы: `UPPER_SNAKE_CASE`
- Осмысленные имена: `message` вместо `msg`, `bot_token` вместо `token`

## Telegram Bot

- Один handler на один тип взаимодействия
- Переменная сессии/контекста для состояния пользователя (если нужно)
- Все текстовые ответы — читаемые и понятные

## LLM

- Системный промпт описывает роль и контекст
- User сообщение — простой текст от пользователя
- Подготовка контекста: только необходимые сообщения для диалога

## Конфигурация

- Всё в `.env` файле
- Загрузка через `os.getenv()` или `python-dotenv`
- Понятные имена переменных: `TELEGRAM_BOT_TOKEN`, `OPENROUTER_API_KEY`

## Логирование

- Уровни: INFO для основных событий, ERROR для ошибок
- Формат: `logging.info("Получено сообщение от пользователя %s", user_id)`
- В лог: суть действия, не детали реализации
@conventions.md
